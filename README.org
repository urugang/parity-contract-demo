* install [[https://github.com/paritytech/parity][parity]]

#+begin_src shell
  $ git clone --depth=1 git@github.com:paritytech/parity  
  $ cd parity  
  $ cargo install --force --debug  
#+end_src

* install [[https://nodejs.org/en/][nodejs]]

#+begin_src shell
  $ wget https://nodejs.org/dist/v8.1.4/node-v8.1.4-linux-x64.tar.xz  
  $ tar xf node-v8.1.4-linux-x64.tar.xz  
  $ export PATH=$PWD/node-v8.1.4-linux-x64/bin:$PATH  
#+end_src

* setup parity poa
    1) [[https://medium.com/taipei-ethereum-meetup/%E4%BD%BF%E7%94%A8parity%E5%BB%BA%E7%AB%8Bproof-of-authority-poa-ethereum-chain-c5c1cdd0f21a][使用parity建立proof-of-authority]]  
    2) [[https://github.com/paritytech/parity/wiki/Demo-PoA-tutorial][Demo-PoA-tutorial]]  
    3) [[https://medium.com/taipei-ethereum-meetup/%E4%BD%BF%E7%94%A8node-js%E9%83%A8%E7%BD%B2%E6%99%BA%E8%83%BD%E5%90%88%E7%B4%84-smart-contract-520534305aaf][使用node-js部署智能合約]]  
       
#+begin_src shell
  $ bash setup.sh  
  Loading config file from node0.toml   
  2 account(s) imported  
  Loading config file from node1.toml  
  2 account(s) imported  
  ................................................................................................................................................  
  "enode://957304a1812a09ba4a0ed8811ddfe77e809b295f343101a41c479e9184a1878dffb4749dc8a77b09128f1a8a688f1b9964433e6a7875f96e941de4d2e856d18d@192.168.1.122:30300"  
  ,{"jsonrpc":"2.0","result":true,"id":0}  
  31735 79.5  2.3 540368 187840 pts/3   Sl+  09:52   0:01 parity ui --config node0.toml --ui-no-validation  
  31736 54.0  2.4 540372 199712 pts/3   Sl+  09:52   0:01 parity ui --config node1.toml --ui-no-validation --ports-shift=100  
  32450  0.0  0.0  18040  1084 pts/3    R+   09:52   0:00 grep parity   
#+end_src

* create contract

#+begin_src shell
$ ./create-contract.js  contracts/BasicToken.sol  
1) connect to ethereum node: http://localhost:8545  
2) unlock account  
   0x00a8afedf7f63bf9e8e45916af8153f109da92b9/node0: ok  
   0x00ae9aa07ad975feb85403866a64f09c1e2e05f7/user0: ok  
3) compile contract file: contracts/BasicToken.sol  
4) deploy contract  
   BasicToken.abi: [{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"balance","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[],"name":"whoami","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"inputs":[],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"from","type":"address"},{"indexed":true,"name":"to","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"me","type":"address"}],"name":"Whoami","type":"event"}]  
   BasicToken.bc: 0x6060604052341561000f57600080fd5b5b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550612710600260008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055505b5b6104b0806100c86000396000f30060606040526000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806318160ddd1461006a57806370a08231146100935780638da5cb5b146100e0578063a9059cbb14610135578063b3b36bb314610177575b600080fd5b341561007557600080fd5b61007d6101cc565b6040518082815260200191505060405180910390f35b341561009e57600080fd5b6100ca600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506101d2565b6040518082815260200191505060405180910390f35b34156100eb57600080fd5b6100f361021c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561014057600080fd5b610175600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050610241565b005b341561018257600080fd5b61018a6103c3565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b60015481565b6000600260008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205490505b919050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b61028a600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020548261042f565b600260003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550610316600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205482610449565b600260008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020819055508173ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef836040518082815260200191505060405180910390a35b5050565b60007ffaf1b992abd26a004e10010116cd5ffdd9b75b62e06f9e6897e54892bebbc1b633604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390a13390505b90565b600061043d83831115610474565b81830390505b92915050565b60008082840190506104698482101580156104645750838210155b610474565b8091505b5092915050565b80151561048057600080fd5b5b505600a165627a7a723058205839ad46a6fb02a80def3eaa20ca9c92e4877aad80551ecf54ba2bebf3316d850029  
   BasicToken.txhash: 0xb418a3808ae4ec895ee3f01e6af245854c5caa9f713d2f35e2a1c50e8510e4c9  
   BasicToken.addr: 0x8e8377fcc8b069e171cabae1c94ae41a188c853f  
#+end_src

* call contract
when web ui is enabled, even you unlock account in web3 successfully, you have to input password again in web ui.  

#+begin_src shell
./call-contract.js BasicToken  
1) connect to ethereum node: http://localhost:8545  
2) unlock account  
   0x00a8afedf7f63bf9e8e45916af8153f109da92b9/node0: ok  
   0x00ae9aa07ad975feb85403866a64f09c1e2e05f7/user0: ok  
3) get abi and address  
4) watch Transfer event and call transfer  
tx hash: 0x7d7fe5d6f32494bc998ffb6983dc328a041071497c584f27aa1c44803873fddf   
5) watch Whoami event and call whoami  
tx hash: 0xf02d32e8bccdea9486d374d9b2f5756b89ac5d26704604afa7d5774cce2d4eb2   
Transafer event:  
 { address: '0x8e8377fcc8b069e171cabae1c94ae41a188c853f',  
  blockHash: '0x1faf3c58267e2ce60d90a80fb6fd6837fe2adbf6555eaee88631c01e9b4f4230',  
  blockNumber: 12,  
  logIndex: 0,  
  transactionHash: '0x7d7fe5d6f32494bc998ffb6983dc328a041071497c584f27aa1c44803873fddf',  
  transactionIndex: 0,  
  transactionLogIndex: '0x0',  
  type: 'mined',  
  event: 'Transfer',  
  args:   
   { from: '0x00ae9aa07ad975feb85403866a64f09c1e2e05f7',  
     to: '0x00a8afedf7f63bf9e8e45916af8153f109da92b9',  
     value: { [String: '223'] s: 1, e: 2, c: [Array] } } }  
Whoami event:  
 { address: '0x8e8377fcc8b069e171cabae1c94ae41a188c853f',  
  blockHash: '0x1faf3c58267e2ce60d90a80fb6fd6837fe2adbf6555eaee88631c01e9b4f4230',  
  blockNumber: 12,  
  logIndex: 1,  
  transactionHash: '0xf02d32e8bccdea9486d374d9b2f5756b89ac5d26704604afa7d5774cce2d4eb2',  
  transactionIndex: 1,  
  transactionLogIndex: '0x0',  
  type: 'mined',  
  event: 'Whoami',  
  args: { me: '0x00a8afedf7f63bf9e8e45916af8153f109da92b9' } }
#+end_src

